<html>
    <head>
    </head>
    <body>
        <script src="../src/ishml.js"></script>
        <script>
            var lexicon=ISHML.Lexicon()
            lexicon
                .register("the","a","an").as({part:"article"})
                .register("take").as({key:"take",part:"verb"})
                .register("steal").as({key:"take",part:"verb"})
                .register("grab").as({key:"take",part:"verb"})
                .register("drop").as({key:"drop",part:"verb"})
                .register("leave").as({key:"drop",part:"verb"})
                .register("ring").as({key:"ring",part:"noun", role:"thing"})
                .register("slipper").as({key:"slipper",part:"noun", role:"thing"})
                .register("diamond").as({key:"ring",part:"adjective", role:"thing"})
                .register("ruby").as({key:"ring",part:"adjective", role:"thing"})
                .register("ruby").as({key:"ruby",part:"noun", role:"thing"})
                .register("ruby").as({key:"slipper",part:"adjective", role:"thing"})
                .register("glass").as({key:"slipper",part:"adjective", role:"thing"})
                .register("glass").as({key:"tumbler",part:"noun", role:"thing"})
                .register("tumbler").as({key:"tumbler",part:"noun", role:"thing"})
                .register("ruby").as({key:"miss_ruby",part:"noun", role:"npc"})
                .register("sam").as({key:"sam",part:"noun", role:"npc"})
                .register("from").as({key:"from",part:"preposition", role:"preposition"})
            
            var adjectives=ISHML.Rule()
                .configure({minimum:0, maximum:5, filter:(definition)=>definition.part==="adjective" })  
            var nounPhrase=ISHML.Rule()
            
            nounPhrase
                .configure
                (
                    {  mode:nounPhrase.enum.pick /*,
                        semantics:function({gist,remainder}={}) 
                        {
                            gist.np="Hello"
                            return {gist,remainder}
                        }*/
                    }
                )
                .part("article")    
                .part("adjectives")
                .part("noun")
                
            nounPhrase.article
                .configure({minimum:0, filter:(definition)=>definition.part==="article" })
            nounPhrase.adjectives
                .configure
                (
                    {   minimum:0,
                        maximum:3,
                       filter:(definition)=>definition.part==="adjective" /*,
                        semantics:function({gist,remainder}={}) 
                        {
                            gist.adj="Hello"
                            return {gist,remainder}
                        }*/
                    }
                )
            nounPhrase.noun
                .configure({filter:(definition)=>definition.part==="noun" })     
            
            var grammar=ISHML.Rule()    
      
            grammar.part("command")

            grammar.command
                .configure({mode:grammar.enum.pick})
                .part("option1")
                .part("option2")
                .part("option3")
            
                grammar.command.option1
                .part("subject",nounPhrase)
                .part("verb")
                .part("directObject",nounPhrase)
            grammar.command.option1.subject
                .configure({minimum:0})
            grammar.command.option1.verb
                .configure({filter:(definition)=>definition.part==="verb"})
            grammar.command.option1.directObject
                .configure({minimum:0})
            
                grammar.command.option2
                .part("subject",nounPhrase)
                .part("verb")
                .part("directObject",nounPhrase)
                .part("indirectObject",nounPhrase)
            grammar.command.option2.subject
                .configure({minimum:0})
            grammar.command.option2.verb
                .configure({filter:(definition)=>definition.part==="verb"})
            grammar.command.option2.indirectObject
                .part("preposition")
                .part("nounPhrase",nounPhrase)
            grammar.command.option2.indirectObject.preposition
                .configure({filter:(definition)=>definition.part==="preposition"})
            
            grammar.command.option3
                .part("subject",nounPhrase)
                .part("verb")
                .part("indirectObject",nounPhrase)
                .part("directObject",nounPhrase)
            grammar.command.option3.subject
                .configure({minimum:0})
            grammar.command.option3.verb
                .configure({filter:(definition)=>definition.part==="verb"})
        </script>
    </body>
</html>