---
title: Text Generation Part 2
status: pending
---
<div class="container mt-4">
<h1>Text generation Part Two</h1>
<p class="lead">Prerequisites: You should have read <a href="{{ site.baseurl }}{% link _tutorials/phrases1.html %}">Text Generation Part One</a>.</p>

<h1>Anatomy of a Phrase</h1>	
<p>Stored inside of a phrase's array are the text strings, sub-phrases, numbers, and functions that make up the phrase. When a phrase's <code>.say()</code> method is called, the phrase is evaluated and the phrase's <code>text</code> property is updated.  The default evaluation is to join all the elements of the array together.  If an array element is another phrase or a function, it will be evaluated before concatenation.   We can change the default evaluation by adding modifiers to the phrase's definition. Modifiers that are methods of <code>ishml.Phrase</code> are called <b>prefixes</b>.  Modifiers that are methods of the text generation function created by <code>ishml.Phrase</code> are called <b>suffixes</b>.  A key characteristic of modifiers is that they always return a new phrase.  Modifiers maybe chained together to create complex phrases with just a single line of code. </p>

<h1>Prefixes</h1>
<p>A complete list of the built-in prefixes is available in the <a href="{{ site.baseurl }}{% link api.html %}">API Reference</a>. The JavasScript tab in listing 1 shows a few examples of prefixes in use.</p>
<span class="badge badge-info">Listing 1</span>
<iframe id="listing1" width="100%" height="250" src="//jsfiddle.net/bikibird/40nh7ev2/embedded/html,js,result/?fontColor=ffffff&menuColor=17a2b8" frameborder="0" class="rounded shadow" title="Listing 1"></iframe>
<p>The phrase defined for <code>umodifiedPhrase</code> evaluates to "JackJillJamal went to the humane society and came home with dogcatocelotemu." </p>
<p>Adding the <code>.pick</code> prefix to the inner phrases of <code>pickPhrase</code> causes a name and an animal to be chosen completely at random, like rolling a pair of dice each time <code>.say</code> is called. The inner phrases of <code>cyclePhrase</code> usses the <code>.cycle</code> prefix to cause names and animals to be selected in order, looping around to the begin again once the list is exhausted.</p>


<h2>Series</h2>
<p>Examine the Javascript tab in listing 1.  The phrase defined for <code>defaultPhrase</code> evaluates to "Hello, MecuryVenusEarthMars." This behavior may be changed by adding a suffix.</p>
<p>Adding the <code>.pick</code> suffix to the inner phrase of <code>pickPhrase</code> causes a planet to be chosen completely at random, like rolling a pair of dice.  Adding the <code>.cycle</code> suffix causes the planets to be selected in order, looping around to the begin again once the list is exhausted.</p>

<p>Switch to the Javascript tab and study the code. First, we assign <code>ishml.Phrase</code> to a variable represented by an underscore.  This is simply for convenience so that we don't have to type out <code>ishml.Phrase</code> over and over. The underscore was chosen because it reflects the "fill in the blanks" nature of text generation. Next we assign a phrase to the myPhrase variable. This phrase happens to be a nested phrase. The outer phrase, <q>Hello, _____</q>, has an expression, denoted by <code>${...}</code>, which is also a phrase.  The inner phrase fills in the blank of the outer phrase with a random planet each time the text is generated. The lasst line of script does the actual work of generating the text and places it inside the <code>h1</code> element.</p>
<h1>Creating Phrases</h1>
<p>The syntax for creating phrases is designed to get out of your way and let you have a sense of the text to be generated just by glancing at the code.  Sometimes template literal notation is preferred, sometimes standard function call notation is easier.  Sometimes a deeply nested inline structure is the most straightforward, sometimes it is less confusing to predefine the inner phrases separately and then reference them in the outer phrase. It is often just a matter of style and as you become more familiar with phrases, you will develop your own style.  Listing 2 below demonstrates many styles of phrase creation.</p>
<span class="badge badge-info">Listing 2</span>
<iframe id="listing2" width="100%" height="300" src="//jsfiddle.net/bikibird/t5dx8aj1/latest/embedded/js/?fontColor=ffffff&menuColor=17a2b8" frameborder="0" class="shadow"  title="Listing 2"></iframe>

<h1>Modern American English Suffixes</h1>
<h1>Prefixes</h1>
<p>Example 1 defines a phrase by using template literal notation. (If you are unfamiliar with template literals and tagged templates, please be sure to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">read up</a> on them before continuing this tutorial.)  Unlike standard template literals, <code>ishml.Phrase</code> returns a text generation function, not a simple string. The actual string, <q>Hello, world</q>, in <code>example1</code> is hidden away in an array attached to the function.</p>
<p>Examples 2, 3, and 5 show the creation of phrases using standard function call notation. The <i>a</i> variation of the examples show each data value passed as a separate argument.  The <i>b</i> variation passes in a single array of values.  Both variations produce identical results.  While it is common for the data to be a series of strings, you may also pass in complex data objects, phrases, numbers, or even functions that return phrases, strings, or numbers.  You may mix any of these types freely. </p>
<p>Examples 4a and 4b are nested phrases, which mix both notation styles.  The outer phrase is defined using template literal notation.  The expression inside the template, denoted by <code>${...}</code>, is a phrase. Acceptable expressions are expression that evaluate to phrases, strings, numbers, or functions that when called during evaluation return phrases, strings, or numbers.</p>
<p>Examples 6a and 6b are empty phrases devoid of data.  Leaving the data out of nested phrases can sometimes make the code easier to read.  Data may always be added or replaced after the initial creation of a phrase.  </p>

<h1>Populating Phrases</h1>
<p>Phrase data may be updated anytime by calling the phrase with data.  Listing 3 shows some examples of populating phrases with data.</p>

<iframe id="listing3" width="100%" height="300" src="//jsfiddle.net/bikibird/phwym1ns/latest/embedded/js/?fontColor=ffffff&menuColor=17a2b8" frameborder="0" class="shadow"  title="Listing 3"></iframe>
<p>Examine how the <code>worlds</code> phrase is populated.  Is is being populated with a list of arguments or an array of values. The incoming data will completely replace the phrase's internal array of data.</p>
<p> Often, we want to be more selective when populating a phrase and send data to to specific sub-phrases. This is done by tagging the sub-phrases when the phrase is defined.  Study the definition of <code>myPhrase</code>.  The phrase uses template literal notations and contains two expressions, which are phrases.   The sub-phrases have the <code>tag</code> suffix appended to them.  This assigns an ID tag to each of the phrases, <q>planet</q> and <q>remark</q>. Tagged phrases provide a means for referencing specific sub-phrases when populating the outer phrase. In this example myPhrase is called with an Object as an argument.  The property keys of the Object are matched against the ID tags of the sub-phrases and the data contained in each matching property of the Object is sent to populate the sub-phrase.</p>

<h1>Saying Something</h1>
<p>Now that we know how to define and populate phrases, let's generate some text.</p>

<iframe id="listing4" width="100%" height="350" src="//jsfiddle.net/bikibird/ohkpn7gu/latest/embedded/html,js,result/?fontColor=ffffff&menuColor=17a2b8" frameborder="0" class="shadow"  title="Listing 4"></iframe>

<p>Examine the Javascript in listing 4 above.  Phrases are evaluated by calling the phrase's <code>say()</code> method. This method updates the phrase's <code>text</code> property with the generated text string and then returns the phrase. The first <code>console.log()</code> demonstrates accessing the generated text.  The second demonstrates generating and accessing the text in one statement.</p>
<p>Phrases also provide methods for updating web pages. The <code>replace()</code> method takes a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors">CSS selector string</a> as its argument. This method replaces the contents of all elements in the HTML document matching the selector string with the generated text. <code>append()</code> and <code>prepend()</code> work in a similar manner accept that they append and prepend the elements' contents.  click on the result tab above to see a live demonstration.</p>
<p>Continue to <!--a href="{{ site.baseurl }}{% link _tutorials/phrases2.html %}">part two</a--> to learn about more complex grammars, including choice rules and semantic analysis.</p>

</div>    

       
